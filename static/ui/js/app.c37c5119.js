(function(e){function t(t){for(var s,a,o=t[0],l=t[1],c=t[2],d=0,u=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&u.push(r[a][0]),r[a]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);h&&h(t);while(u.length)u.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],s=!0,o=1;o<n.length;o++){var l=n[o];0!==r[l]&&(s=!1)}s&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var s={},r={app:0},i=[];function a(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=s,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var h=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e9f5"),n("7d54");var s=n("2b0e"),r=function(){var e=this,t=e._self._c;return t("el-container",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{id:"app","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[t("el-aside",[t("div",{staticClass:"toolbar"},[t("el-select",{staticClass:"toolbar-item",attrs:{placeholder:"repo",size:"mini",filterable:""},on:{change:e.onRepoChange},model:{value:e.selectedRepo,callback:function(t){e.selectedRepo=t},expression:"selectedRepo"}},e._l(e.repoList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1),t("el-select",{staticClass:"toolbar-item",attrs:{placeholder:"branch",size:"mini",filterable:""},on:{change:e.onBranchChange},model:{value:e.selectedBranch,callback:function(t){e.selectedBranch=t},expression:"selectedBranch"}},e._l(e.branchList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1),t("el-radio-group",{attrs:{size:"mini"},on:{change:e.onModeChange},model:{value:e.viewMode,callback:function(t){e.viewMode=t},expression:"viewMode"}},[t("el-radio-button",{attrs:{label:"doc"}},[e._v("文档")]),t("el-radio-button",{attrs:{label:"diff"}},[e._v("Diff")])],1),t("el-button",{attrs:{size:"mini"},on:{click:e.refreshCurrent}},[e._v("刷新")]),"diff"===e.viewMode?t("div",{staticClass:"toolbar-row"},[t("el-select",{staticClass:"toolbar-item",attrs:{placeholder:"base",size:"mini",filterable:""},on:{change:e.onBaseChange},model:{value:e.baseBranch,callback:function(t){e.baseBranch=t},expression:"baseBranch"}},e._l(e.branchList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1),t("el-select",{staticClass:"toolbar-item",attrs:{placeholder:"target",size:"mini",filterable:""},on:{change:e.onTargetChange},model:{value:e.targetBranch,callback:function(t){e.targetBranch=t},expression:"targetBranch"}},e._l(e.branchList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1):e._e()],1),t("el-input",{staticClass:"search-input",attrs:{placeholder:"select...",clearable:""},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}}),t("left-nav",{directives:[{name:"loading",rawName:"v-loading",value:e.inputLoading,expression:"inputLoading"}],staticClass:"left-nav",attrs:{menus:e.menus}})],1),t("el-main",[t("el-button",{on:{click:e.goHome}},[e._v("Home")]),"doc"===e.viewMode&&Object.keys(e.menus).length>0?t("div",{directives:[{name:"highlight",rawName:"v-highlight"}],domProps:{innerHTML:e._s(e.htmlDoc)}}):e._e(),"diff"===e.viewMode?t("div",{directives:[{name:"highlight",rawName:"v-highlight"}],domProps:{innerHTML:e._s(e.htmlDiff)}}):e._e()],1)],1)},i=[],a=(n("910d"),n("ab43"),n("88a7"),n("271a"),n("5494"),function(){var e=this,t=e._self._c;return t("el-menu",{staticClass:"left-menu",attrs:{"unique-opened":""},on:{open:e.handleOpen,close:e.handleClose}},e._l(Object.values(e.getMenus(e.menus)),(function(e,n){return t("menu-elem",{key:e.$name,attrs:{index:String(n),data:e}})})),1)}),o=[],l=function(){var e=this,t=e._self._c;return e.data.$hidden?e._e():t("div",["method"!==e.data.$type?t("el-submenu",{attrs:{index:e.index}},[t("template",{slot:"title"},[t("span",{on:{click:e.setContent}},[e._v(e._s(e.data.$label))])]),e._l(e.child,(function(n,s){return t("menu-elem",{key:n.$name,attrs:{data:n,index:e.index+s}})}))],2):t("el-menu-item",{on:{click:e.setContent}},[e._v(e._s(e.data.$label))])],1)},c=[],h={name:"MenuElem",props:{index:{type:String,default:()=>0},data:{type:Object,default:()=>{}}},data(){return{child:this.getChild(this.data)}},methods:{getChild(e){return Object.keys(e).filter(e=>!e.startsWith("$")).map(t=>e[t])},setContent(){this.$store.state.content=this.data}}},d=h,u=n("2877"),f=Object(u["a"])(d,l,c,!1,null,null,null),p=f.exports,b={components:{MenuElem:p},props:{menus:{type:Object,default:()=>{}}},data(){return{}},methods:{getMenus(e){const t={};for(const n of Object.keys(e))n.startsWith("$")||(t[n]=e[n]);return t},handleOpen(e,t){},handleClose(e,t){}}},g=b,$=(n("bef2"),Object(u["a"])(g,a,o,!1,null,"14befc3f",null)),m=$.exports,v=n("0e54"),y=n.n(v),k={components:{LeftNav:m},data(){return{searchStr:"",menus:{},searchId:"",inputLoading:!1,repos:{},repoList:[],branchList:[],selectedRepo:"",selectedBranch:"",viewMode:"doc",baseBranch:"",targetBranch:"",diffResult:null,diffLoading:!1}},computed:{isLoading(){return"diff"===this.viewMode?this.diffLoading:Object.keys(this.menus).length<=0},htmlDoc(){return y()(this.buildMd(this.$store.state.content)).replace(/&lt;br&gt;/g,"\n")},htmlDiff(){return y()(this.buildDiffMd(this.diffResult)).replace(/&lt;br&gt;/g,"\n")}},watch:{searchStr(){this.searchId&&clearTimeout(this.searchId),this.inputLoading=!0,this.searchId=setTimeout(()=>{for(const e of Object.values(this.menus)){for(const t of Object.values(e))this.filterData(t,this.searchStr),this.checkHidden(t);this.checkHidden(e)}this.inputLoading=!1,this.updateUrl()},1e3)}},mounted(){this.loadRepos(),y.a.setOptions({renderer:new y.a.Renderer,gfm:!0,tables:!0,breaks:!1,pedantic:!1,smartLists:!0,sanitize:!0,smartypants:!1})},methods:{loadRepos(){this.$http.get("/repos").then(e=>{const t=e.data&&e.data.repos?e.data.repos:{};this.repos=t||{},this.repoList=Object.keys(this.repos);const n=new URLSearchParams(location.search),s=n.get("repo"),r=n.get("branch"),i=n.get("base"),a=n.get("target"),o=n.get("mode"),l=n.get("q")||n.get("search")||"";this.searchStr=l,this.repoList.length>0&&(this.selectedRepo=s||this.repoList[0],this.updateBranchList(),this.branchList.length>0&&(this.selectedBranch=r||this.branchList[0],this.baseBranch=i||this.branchList[0],this.targetBranch=a||this.branchList[1]||this.branchList[0])),this.viewMode="diff"===o?"diff":"doc",this.refreshCurrent()}).catch(()=>{this.refreshCurrent()})},updateBranchList(){this.branchList=(this.repos[this.selectedRepo]||[]).slice()},onRepoChange(){this.updateBranchList(),this.selectedBranch=this.branchList[0]||"",this.baseBranch=this.branchList[0]||"",this.targetBranch=this.branchList[1]||this.branchList[0]||"",this.refreshCurrent()},onBranchChange(){"doc"===this.viewMode&&this.loadData()},onBaseChange(){"diff"===this.viewMode&&this.loadDiff()},onTargetChange(){"diff"===this.viewMode&&this.loadDiff()},onModeChange(){this.refreshCurrent()},refreshCurrent(){"diff"===this.viewMode?this.loadDiff():this.loadData()},loadData(){const e={};this.selectedRepo&&(e.repo=this.selectedRepo),this.selectedBranch&&(e.branch=this.selectedBranch),this.$http.get("/data",e).then(e=>{this.menus=e.data||{},window.$weDocs=this.menus,this.$store.state.content=this.menus,this.updateUrl()})},loadDiff(){this.selectedRepo&&this.baseBranch&&this.targetBranch?(this.diffLoading=!0,this.$http.get("/diff",{repo:this.selectedRepo,base:this.baseBranch,target:this.targetBranch}).then(e=>{this.diffResult=e.data||{},this.diffLoading=!1,this.updateUrl()}).catch(()=>{this.diffLoading=!1})):this.diffResult={$type:"diff",$base:this.baseBranch,$target:this.targetBranch,added:[],removed:[],changed:[]}},updateUrl(){const e=new URLSearchParams;this.selectedRepo&&e.set("repo",this.selectedRepo),this.selectedBranch&&e.set("branch",this.selectedBranch),this.baseBranch&&e.set("base",this.baseBranch),this.targetBranch&&e.set("target",this.targetBranch),this.viewMode&&e.set("mode",this.viewMode),this.searchStr&&e.set("q",this.searchStr);const t=e.toString(),n=t?"?"+t:location.pathname;window.history.replaceState(null,"",n)},goHome(){this.$store.state.content=this.menus},checkHidden(e){if("object"!==typeof e)return;let t=0;for(const n of Object.values(e))if("object"===typeof n&&!n.$hidden){t++;break}e.$hidden=t<=0},buildMatchStr(...e){const t="";return e?e.map(e=>e?e.trim():"").filter(e=>e).join(" "):t},filterData(e,t){"object"===typeof e&&(t=t||"",Object.keys(e).forEach(n=>{if("object"!==typeof e[n])return;if(!t)return void(e[n].$hidden=!1);let s=e[n].$matchStr||this.buildMatchStr(n,e[n].$name,e[n].$label,e[n].$title,e[n].$profile,e[n].$url,Object.keys(e[n].$deps||{}).join(","));s=s.toUpperCase(),e[n].$matchStr=s;let r=!1;for(const e of t.split(/\s+/).filter(e=>e))if(-1===s.indexOf(e.toUpperCase())){r=!0;break}e[n].$hidden=r}))},trimDesc(e){return e?e.replace(/[\/*]+/g,"").trim().replace(/[\n]+/g,"<br>"):""},buildDeps(e){if(!e.$deps)return"";const t=Object.values(e.$deps||{});let n="##### Deps\n";n+="|GroupId|ArtifactId|version|\n|---|---|---|\n";for(const s of t)n+=`|${s.groupId}|${s.artifactId}|${this.getVersion(e,s.version)}|\n`;return n},buildTable(e,t,n){let s="";s=t?`#### ${t}\n`:`##### - ${e.$type}\n`,s+="|字段名称|类型|是否必填|描述|\n|---|---|---|---|\n";const r={};for(const i of Object.keys(e)){if(i.startsWith("$"))continue;const t=e[i];s+=`|${i}|${t.$type}|${this.isRequired(t.$desc)}|${this.trimDesc(t.$desc)}|\n`,Object.keys(t).filter(e=>!e.startsWith("$")).length>0&&(r[t.$type]=t)}for(const i of Object.values(r))n[i.$type]||(s+=this.buildTable(i,null,n),n[i.$type]=i);return s},isRequired(e){const t=["@NotBlank","@NotEmpty","@NotNull","@NoneNull"];for(const n of t)if(-1!==e.indexOf(n))return"True";return""},getVersion(e,t){if(!t)return t;const n=(e.$repo||{}).$properties;while(t.startsWith("${")){"${project.version}"===t&&(t=e.$version);const s=n[t.replace(/[${}]/g,"")];if(!s)break;t=s}return t},asLine(...e){return e.filter(e=>e).join("\n").trim()},buildErrorCode(e){if(!e)return"";let t="#### Error Code\n";t+="|错误编码|错误信息|\n|---|---|\n";for(const n of Object.keys(e))t+=`|${n}|${e[n]}|\n`;return t},buildNexusDeps(e){if(!e.$nexusDeps)return"";let t="|模块|最近版本|\n|---|---|\n";return Object.keys(e.$nexusDeps).filter(e=>!e.startsWith("$")).forEach(n=>{const s=e.$nexusDeps[n].filter(e=>!e.match(/-20.*$/));t+=`|${n}|${s.filter((e,t)=>s.indexOf(e)===t).slice(-9).join(" / ")}|\n`}),`\n#### NexusDeps Version\nUrl: ${e.$nexusBrowseUrl}\n\n${t}\n      `},buildDiffMd(e){if(!e)return"加载中...";const t=e.$base||"",n=e.$target||"",s=[{key:"http",title:"HTTP 接口"},{key:"dubbo",title:"Dubbo 接口"},{key:"enum",title:"枚举"}],r=(e.added||[]).length,i=(e.removed||[]).length,a=(e.changed||[]).length;let o=`\n### Diff (${t} -> ${n})\n\n- 新增: ${r}\n- 删除: ${i}\n- 变更: ${a}\n`;const l=(e,t,n)=>{if(!t||t.length<=0)return"";let s=`\n#### ${e} (${t.length})\n`;return t.forEach(e=>{const t=e.title||e.key||e.name||"";if(n&&e.changes){const n=Object.keys(e.changes).join(", ");s+=`- ${t} [${n}]\n`}else s+=`- ${t}\n`}),s};return s.forEach(t=>{const n=e[t.key];n&&(o+=`\n### ${t.title}\n`,o+=l("新增",n.added,!1),o+=l("删除",n.removed,!1),o+=l("变更",n.changed,!0))}),o},buildMd(e){const t=e.$repo||e.$branch?`\n#### Git Repo\n\`\`\`\n${e.$repo.$repo||""}\n${e.$repo.$branch||""}\n\`\`\`\n`:"",n=`\n${e.$url?"#### URL: "+e.$url:""}\n\n${e.$requestMethod?"#### Method: "+e.$requestMethod:""}\n`,s=`\n\`\`\`\n${this.asLine(e.$desc,e.$profile,e.$version?"<version>"+this.getVersion(e,e.$version)+"</version>":"")}\n\`\`\`\n`,r=e.$params?this.buildTable(e.$params,"Params",{}):"",i=e.$result?this.buildTable(e.$result,"Result",{}):"",a=this.buildErrorCode(e.$errorCode),o=this.buildDeps(e),l=this.buildNexusDeps(e),c=`\n### ${e.$title}\n${n}\n${s}\n${t}\n${r}\n${i}\n${a}\n${o}\n${l}\n`;return console.log(c),c}}},L=k,w=(n("5df2"),n("d46a"),Object(u["a"])(L,r,i,!1,null,"bcd769de",null)),j=w.exports,B=n("5c96"),O=n.n(B),C=(n("0fae"),n("bc3a")),M=n.n(C);const x=M.a.create({baseURL:null,timeout:6e4});var _={get:(e,t)=>x({url:e,params:t,method:"get"}),post:(e,t)=>x({url:e,data:t,method:"post"})};s["default"].prototype.$http=_;var D=n("2f62");s["default"].use(D["a"]);const R=new D["a"].Store({state:{content:""}});var S=R,T=n("1487"),N=n.n(T);n("8da8");s["default"].directive("highlight",e=>{const t=e.querySelectorAll("pre code");t.forEach(e=>{N.a.highlightBlock(e)})}),s["default"].use(O.a),s["default"].config.productionTip=!1,s["default"].prototype.$content="",new s["default"]({store:S,render:e=>e(j)}).$mount("#app")},"5df2":function(e,t,n){"use strict";n("7459")},7459:function(e,t,n){},"7adc":function(e,t,n){},bef2:function(e,t,n){"use strict";n("cc78")},cc78:function(e,t,n){},d46a:function(e,t,n){"use strict";n("7adc")}});
//# sourceMappingURL=app.c37c5119.js.map